language: python
python:
  - "3.6"
  - "3.6-dev"  # 3.6 development branch
  - "3.7-dev"  
# command to install dependencies
install:
  - pip install -r requirements.txt
# command to run tests
script:
  - pytest

#
services:
  - postgresql

before_script:
  - export FLASK_APP=common.py
  - export FLASK_DEBUG=1
  - export DB_CONNNECTION_STRING=postgresql://postgres:@localhost/sto1
  - psql -c 'create database sto1;' -U postgres
  - python3 common.py db init
  - python3 common.py db migrate
  - python3 common.py db upgrade
  